# Mosquitto MQTT Broker Configuration for NWWS2MQTT

# General Configuration
pid_file /var/run/mosquitto.pid
persistence true
persistence_location /mosquitto/data/
log_dest file /mosquitto/log/mosquitto.log
log_dest stdout
log_type error
log_type warning
log_type notice
log_type information

# Connection settings
max_connections 1000
max_inflight_messages 100
max_queued_messages 1000

# Network Configuration
bind_address 0.0.0.0

# MQTT Protocol Configuration
listener 1883
protocol mqtt

# WebSocket Configuration (optional)
listener 9001
protocol websockets

# Security Configuration
allow_anonymous true
# For production, consider setting up authentication:
# password_file /mosquitto/config/passwd
# acl_file /mosquitto/config/acl

# Message size limits
message_size_limit 268435456  # 256MB for large weather data

# Quality of Service
max_queued_messages 1000
max_inflight_messages 20

# Logging Configuration
connection_messages true
log_timestamp true
log_timestamp_format %Y-%m-%dT%H:%M:%S

# Persistence Configuration
autosave_interval 1800
autosave_on_changes false
persistent_client_expiration 2h

# Bridge Configuration (if needed for external MQTT brokers)
# connection bridge-01
# address external.mqtt.broker:1883
# topic nwws/# out 0
# topic command/# in 0
